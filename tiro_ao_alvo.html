<!DOCTYPE html>
<html>
	<!--Autor: Cayo Aguiar do Nascimento
		https://github.com/cayocan/Tiro-ao-Alvo_Javascript-->
	<head>
		<META charset="UTF-8"/>
		<title>Tiro ao Alvo</title>
	</head>

	<body>
		<div align="center">
			<canvas id="tela" width="1000" height="800"></canvas>
		</div>
		<script type="text/javascript">
			var tela = document.getElementById("tela");
			var c = tela.getContext("2d");
			
			var telaX = 1000;//Tamanho da tela no eixo X.
			var telaY = 800;//Tamanho da tela no eixo Y.
			
			var raio = 40;//tamanho do raio do alvo.
			var alvoX;//Posição do alvo em relação ao eixo X.
			var alvoY;//Posição do alvo em relação ao eixo Y.
			
			var tempoAlvo = 300;
			var contClick = 0;
			
			var cor = function(color){
				c.fillStyle = color;
			};
			
			var circulo = function(x,y,raio){
				c.beginPath();
				c.arc(x,y,raio,0,2*Math.PI);
				c.fill();
			};

			var desenhaAlvo = function(x, y) {
			    cor("white");
			    circulo(x, y, raio);
			    cor("red");
			    circulo(x, y, raio-10);
			    cor("white");
			    circulo(x, y, raio-20);
			    cor("red");
			    circulo(x, y, raio-30);
			};
			
			var acerto = function(evento){
				//TODO implement this method
				var mouseX = evento.pageX - tela.offsetLeft;
				var mouseY = evento.pageY - tela.offsetTop;
				contClick++;
				
				if((mouseX > alvoX - raio) && (mouseX < alvoX + raio) && (mouseY > alvoY - raio) && (mouseY < alvoY + raio)){
					limpa();
					alert("Parabéns, vc acertou o alvo!\nVocê clicou: "+contClick+" vezes.");
					window.location.href="index.html"
					contClick = 0;
				}
				
				console.log("X: "+mouseX+"\nY: "+mouseY);
			};
			
			var sorteia = function(reach){
				return Math.round(Math.random() * ((reach) - 1) + 1);
			};

			var limpa = function(){
				c.clearRect(0,0,telaX,telaY);
			};
			
			var desenha = function() {
				limpa();
				alvoX = sorteia(telaX);
				alvoY = sorteia(telaY);
				desenhaAlvo(alvoX, alvoY);
				c.strokeRect(0,0,telaX,telaY);
			};

			setInterval(desenha, tempoAlvo);
			tela.onclick = acerto;
		</script>
	</body>
</html>
