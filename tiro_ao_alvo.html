<!DOCTYPE html>
<html>
	<!--Autor: Cayo Aguiar do Nascimento
		https://github.com/cayocan/Tiro-ao-Alvo_Javascript-->
	<head>
		<META charset="UTF-8"/>
		<link rel="shortcut icon" href="img/alvo.png"/>
		<title>Fastarget - game</title>
	</head>

	<body>
		<div align="center">
			<h1>Tente acertar o alvo clicando sobre ele</h1>
			<a id="botaoVoltar" href="index.html">Voltar</a>
			<a id="botaoReiniciar"href="tiro_ao_alvo.html">Reiniciar</a>
			<br>
			<canvas id="tela" width="1200" height="700"></canvas>
			<h2>Quanto menos cliques, melhor sua pontuação</h2>
			<p>Criador: Cayo Aguiar do Nascimento | Versão Beta: 1.0.1</p>
		</div>
		<script type="text/javascript">
			var tela = document.getElementById("tela");
			var c = tela.getContext("2d");
			
			var telaX = 1200;//Tamanho da tela no eixo X.
			var telaY = 700;//Tamanho da tela no eixo Y.
			
			var raio = 40;//tamanho do raio do alvo.
			var alvoX;//Posição do alvo em relação ao eixo X.
			var alvoY;//Posição do alvo em relação ao eixo Y.
			
			var tempoAlvo = 1000;//Variável responsável pela velocidade de mudança do alvo em (milisegundos).
			var contClick = 0;
			
			var cor = function(color){
				c.fillStyle = color;
			};
			
			var circulo = function(x,y,raio){
				c.beginPath();
				c.arc(x,y,raio,0,2*Math.PI);
				c.fill();
			};
			
			var desenhaMoldura = function(){
				c.strokeRect(0,0,telaX,telaY);
			}
			
			var desenhaAlvo = function(x, y) {
			    cor("white");
			    circulo(x, y, raio);
			    cor("red");
			    circulo(x, y, raio-10);
			    cor("white");
			    circulo(x, y, raio-20);
			    cor("red");
			    circulo(x, y, raio-30);
			};
			
			var acerto = function(evento){
				var mouseX = evento.pageX - tela.offsetLeft;
				var mouseY = evento.pageY - tela.offsetTop;
				contClick++;
				
				if((mouseX > alvoX - raio) && (mouseX < alvoX + raio) && (mouseY > alvoY - raio) && (mouseY < alvoY + raio)){
					clearInterval(intervalId);
					limpa();
					alert("Parabéns, vc acertou o alvo!\nCliques até acertar: "+contClick+" clique(s).");
					window.location.href="index.html"
					contClick = 0;
				}
				
				console.log("X: "+mouseX+"\nY: "+mouseY);
			};
			
			var sorteia = function(reach){
				return Math.round(Math.random() * ((reach) - 1) + 1);
			};

			var limpa = function(){
				c.clearRect(0,0,telaX,telaY);
			};
			
			var desenha = function() {
				limpa();
				alvoX = sorteia(telaX);
				alvoY = sorteia(telaY);
				desenhaAlvo(alvoX, alvoY);
				desenhaMoldura();
			};
			
			desenhaMoldura();
			var intervalId = setInterval(desenha, tempoAlvo);
			tela.onclick = acerto;
		</script>
	</body>
</html>
